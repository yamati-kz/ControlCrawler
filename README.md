# ロボット制御用ソフトウェア 要件定義書

## 1. 文書の目的
1.1 本書は、ロボット制御用ソフトウェアの開発に必要な要件を定義し、関係者間で共通の理解を形成するためのものです。本プロジェクトは、ROS 2およびmros 2-esp32を使用してロボットの原理試作を実施します。

---

## 2. システム概要

### 2.1 背景
2.1.1 ロボット制御システムの試作を通じて、ROS 2とESP32による分散制御環境を構築し、センサー入力とモータ制御の基本的な機能を実現します。

### 2.2 システムの概要
2.2.1 本システムは以下の要素を含みます:

#### 2.2.1 ハードウェア
- 2.2.1.1 Nvidia Jetson Orin Nano Developer Kit
- 2.2.1.2 Seeed Studio XIAO ESP32C6
- 2.2.1.3 Seeed Studio XIAO ESP32C2
- 2.2.1.4 Dealsense DCモータ
- 2.2.1.5 HC-SR04超音波センサ
- 2.2.1.6 ユニバーサル基板（モータドライバIC、DCモータ、超音波センサ、制御マイコンを搭載）
- 2.2.1.7 安定化電源（Matsusada Precision、12V出力）

#### 2.2.2 ソフトウェア
- 2.2.2.1 ROS 2 (Ubuntu 22.04 LTS)
- 2.2.2.2 ESP-IDF (Ubuntu 22.04 LTS)

---

## 3. スコープ

### 3.1 対象範囲
- 3.1.1 ユニバーサル基板を用いたハードウェア構成の試作
- 3.1.2 ROS 2およびESP32を使用した制御ソフトウェアの開発
- 3.1.3 DCモータおよび超音波センサの動作確認

### 3.2 除外範囲
- 3.2.1 実運用に耐えうる設計および製品化
- 3.2.2 長期間の耐久試験

---

## 4. 要件

### 4.1 機能要件

#### 4.1.1 DCモータ制御
- 4.1.1.1 ESP32C6を使用し、DCモータをモータドライバICを介して制御。
- 4.1.1.2 前進、後退、停止を実現。
- 4.1.1.3 ROS 2コマンドに基づく動作。

#### 4.1.2 超音波センサのデータ取得
- 4.1.2.1 ESP32C3を使用し、HC-SR04センサから距離データを取得。
- 4.1.2.2 ROS 2コマンドとして距離データを発行。

#### 4.1.3 コマンド操作
- 4.1.3.1 Ubuntu上でDualSenseを操作し、ROS 2コマンドを発行。
- 4.1.3.2 モータ制御（前進、後退、停止）の指示を送信。

### 4.2 非機能要件

#### 4.2.1 リアルタイム性
- 4.2.1.1 センサー入力からモータ制御までの遅延を200ms以下にする。

#### 4.2.2 信頼性
- 4.2.2.1 コマンド送信成功率を99%以上とする。

#### 4.2.3 互換性
- 4.2.3.1 Ubuntu 22.04 LTS環境下での動作を保証。

---

## 5. 使用ハードウェア
- 5.1 Nvidia Jetson Orin Nano Developer Kit
- 5.2 Seeed Studio XIAO ESP32C6
- 5.3 Seeed Studio XIAO ESP32C2
- 5.4 Dealsense DCモータ
- 5.5 HC-SR04 超音波センサ
- 5.6 ユニバーサル基板（電源回路 12Vから5V、3.3Vへの変換を含む）
- 5.7 安定化電源（Matsusada Precision、12V出力）

---

## 6. 開発環境
- 6.1 **OS:** Ubuntu 22.04 LTS
- 6.2 **ESP32開発環境:** ESP-IDF
- 6.3 **開発用ノートPC:** Intel Core i5 8th Gen搭載

---

## 7. テスト計画

### 7.1 テスト対象
- 7.1.1 DCモータの動作確認（前進、後退、停止）
- 7.1.2 超音波センサからの距離データ取得およびROS 2コマンドの発行
- 7.1.3 DualSenseからのROS 2コマンド発行および動作確認

### 7.2 テスト環境
- 7.2.1 Nvidia Jetson Orin Nano Developer Kit上でROS 2を動作
- 7.2.2 ESP32C6およびESP32C2を統合した試作基板を使用

### 7.3 テスト項目
- 7.3.1 モータ制御の精度と応答性
- 7.3.2 超音波センサによるデータ取得精度
- 7.3.3 DualSenseからの入力に対するシステムの応答性

---

## 8. リスクと課題
- 8.1 ESP32とROS 2間の通信遅延やエラーの可能性。
- 8.2 電源回路の安定性がシステム全体の動作に与える影響。
- 8.3 DualSense操作時の通信遅延。

---

## 9. 変更管理
- 9.1 GitHubを使用してソースコードおよびドキュメントを管理。
- 9.2 プルリクエストを通じて変更のレビューと承認を実施。

---

## 10. 付録

### 10.1 使用するハードウェアおよびソフトウェアのデータシート
### 10.2 ROS 2およびESP-IDFの公式ドキュメントリンク

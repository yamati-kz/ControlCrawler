# ロボット制御用ソフトウェア 要件定義書

## 1. 文書の目的
本書は、ロボット制御用ソフトウェアの開発に必要な要件を定義し、関係者間で共通の理解を形成することを目的とする。本プロジェクトでは、ROS 2およびmros 2-esp32を使用し、ロボットの原理試作を実施することを予定している。

## 2. システム概要

### 2.1 背景
本試作を通じて、ROS 2およびESP32による分散制御環境を構築し、センサー入力およびモータ制御に関する基本的な機能を実現することを目指している。

### 2.2 システムの概要
本システムは以下の要素で構成される。

#### 2.2.1 ハードウェア platform/framework
|Tabele 2.2.1 hardware                   |                                |                    |                         |
|-----------------------------------------|---------------------|---------------------|--------------------------| 
| Hardware                                | Specification                  | ROS 2               | build                    |
| [Nvidia Jetson Orin Nano Developer Kit](https://www.nvidia.com/ja-jp/autonomous-machines/embedded-systems/jetson-orin/)    |      |        |              |
| [Seeed Studio XIAO ESP32C6](https://www.seeedstudio.com/Seeed-Studio-XIAO-ESP32C6-p-5884.html) | RISC-V Dual-core 32-bit |    |
| [Seeed Studio XIAO ESP32C3](https://www.seeedstudio.com/Seeed-XIAO-ESP32C3-p-5431.html)|RISC-V single-core 32-bit     |  |  |



| Dealsense DCモータ**                       | 直流モータ（用途に応じたモータ選定）        |
| HC-SR04超音波センサ**                      | 距離計測用の超音波センサ                    |
| ユニバーサル基板**                         | モータドライバIC、DCモータ、超音波センサ、制御マイコンを搭載した基板 |
| 安定化電源（Matsusada Precision製、12V出力）** | 12V出力の安定化電源                        |


#### 2.2.2 ソフトウェア
- **ROS 2** (Ubuntu 22.04 LTS)
- **ESP-IDF** (Ubuntu 22.04 LTS)

## 3. スコープ

### 3.1 対象範囲
- ユニバーサル基板を用いたハードウェア構成の試作
- ROS 2およびESP32を使用した制御ソフトウェアの開発
- DCモータおよび超音波センサの動作確認

### 3.2 除外範囲
- 実運用に耐えうる設計および製品化
- 長期間の耐久試験

## 4. 要件

### 4.1 機能要件

#### 4.1.1 DCモータ制御
- ESP32C6を使用し、DCモータをモータドライバICを介して制御すること。
- 前進、後退、停止を実現すること。
- ROS 2コマンドに基づく動作を実行すること。

#### 4.1.2 超音波センサのデータ取得
- ESP32C3を使用し、HC-SR04センサから距離データを取得すること。
- 距離データをROS 2コマンドとして発行すること。

#### 4.1.3 コマンド操作
- Ubuntu上でDualSenseを操作し、ROS 2コマンドを発行すること。
- モータ制御（前進、後退、停止）の指示を送信すること。

### 4.2 非機能要件
- リアルタイム性: センサー入力からモータ制御までの遅延を200ms以下に抑えること。
- 信頼性: コマンド送信成功率99%以上を達成すること。
- 互換性: Ubuntu 22.04 LTS環境下での動作を保証すること。

## 5. 使用ハードウェア
- **Nvidia Jetson Orin Nano Developer Kit**
- **Seeed Studio XIAO ESP32C6**
- **Seeed Studio XIAO ESP32C2**
- **Dealsense DCモータ**
- **HC-SR04超音波センサ**
- **ユニバーサル基板**（電源回路 12Vから5V、3.3Vへの変換を含む）
- **安定化電源**（Matsusada Precision製、12V出力）

## 6. 開発環境

- **OS**: Ubuntu 22.04 LTS
- **ESP32開発環境**: ESP-IDF  
  ESP-IDFはESP32向けの開発フレームワークであり、ビルドおよびデバッグツールを提供する。ESP32のアプリケーション開発には、ESP-IDFのインストールとツールチェーンの設定が必要である。
- **開発用ノートPC**: Intel Core i5 8th Gen搭載

## 7. テスト計画

### 7.1 テスト対象
- DCモータの動作確認（前進、後退、停止）
- 超音波センサからの距離データ取得およびROS 2コマンドの発行
- DualSenseからのROS 2コマンド発行および動作確認

### 7.2 テスト環境
- Nvidia Jetson Orin Nano Developer Kit上でROS 2を動作させること。
- ESP32C6およびESP32C2を統合した試作基板を使用すること。

### 7.3 テスト項目
- モータ制御の精度と応答性
- 超音波センサによるデータ取得精度
- DualSenseからの入力に対するシステムの応答性

## 8. リスクと課題
- ESP32とROS 2間の通信遅延やエラーの可能性
- 電源回路の安定性がシステム全体に与える影響
- DualSense操作時の通信遅延

## 9. 変更管理
- GitHubを使用してソースコードおよびドキュメントを管理すること。
- プルリクエストを通じて変更のレビューと承認を実施すること。

## 10. 付録

### 10.1 使用するハードウェアおよびソフトウェアのデータシート
### 10.2 ROS 2およびESP-IDFの公式ドキュメントリンク
